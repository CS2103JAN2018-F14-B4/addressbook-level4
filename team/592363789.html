<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>SHI JIN - Project Portfolio</title>
<link rel="stylesheet" href="../stylesheets/gh-pages.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<link rel="stylesheet" href="../stylesheets/coderay-asciidoctor.css">
</head>
<body class="article">
<div id="header">
<h1>SHI JIN - Project Portfolio</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This portfolio highlights my contributions to the project when studying in School of Computing, National University of Singapore.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="project-a-href-https-github-com-cs2103jan2018-f14-b4-main-bibliotek-a"><a class="anchor" href="#project-a-href-https-github-com-cs2103jan2018-f14-b4-main-bibliotek-a"></a>PROJECT: <a href="https://github.com/CS2103JAN2018-F14-B4/main">Bibliotek</a></h2>
<div class="sectionbody">
<hr>
<div class="paragraph">
<p>Bibliotek is a free book cataloguing application that is simple, fast and easy to use.
You can use Bibliotek to search for books, manage your reading list and track the availability of your books.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overview"><a class="anchor" href="#overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Bibliotek is a desktop book management application used for teaching Software Engineering principles. The user interacts with it using a CLI, and it has a GUI created with JavaFX. It is written in Java, and has about 10 kLoC.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="summary-of-contributions"><a class="anchor" href="#summary-of-contributions"></a>Summary of contributions</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><strong>Encrypt data with a password</strong> (major)</p>
<div class="ulist">
<ul>
<li>
<p>Add two class cipherEngine and LockManagement to help encrypt/decrypt the data/password and keep the data safe.</p>
</li>
<li>
<p>Add an ecrypt data function to let bookshelf.xml to be encrypted when user set a non-default password.</p>
</li>
<li>
<p>Add one check of isProtect value in LockManagement to decide whether encrypt the bookshelf.xml before saving the data.</p>
</li>
<li>
<p>Add <code>lock</code>, <code>unlock</code> and <code>setpw</code> command to do lock management. If password is not default(""), everytime user open the application,
he should unlock the bookshelf using password before he can do further instructions.</p>
</li>
<li>
<p>This allows users to keep their data private and safe.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Mark a book as read, change the priority of a book and rate books</strong> (minor)</p>
<div class="ulist">
<ul>
<li>
<p>Added attributes rating, (status and priority by others).</p>
</li>
<li>
<p>Added <code>edit</code> command that allows user to <code>rating</code>, set <code>status</code> and change <code>priority</code> of
some books.</p>
</li>
<li>
<p>Added parser for three attributes.</p>
</li>
<li>
<p>This allows the user to keep track of what to read and what have been read and give recommendations to others.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Set command to be case insensitive</strong>(minor)</p>
<div class="ulist">
<ul>
<li>
<p>Added case insensitive to the command.</p>
</li>
<li>
<p>This allows the user to type in command without worry about the case, and make user easy to use our application.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Code contributed</strong>: [<a href="https://github.com/CS2103JAN2018-F14-B4/main/tree/master/collated/functional.592363789.md">Functional code</a>] [<a href="https://github.com/CS2103JAN2018-F14-B4/main/tree/master/collated/test.592363789.md">Test code</a>] <em>{give links to collated code files}</em></p>
</li>
<li>
<p><strong>Other contributions</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Project management:</p>
</li>
<li>
<p>Enhancements to existing features:</p>
<div class="ulist">
<ul>
<li>
<p>Added the <code>ratingbook</code> command.</p>
</li>
<li>
<p>Added in <code>Edit</code> book command. (Pull requests <a href="https://github.com/CS2103JAN2018-F14-B4/main/pull/111">#111</a>)</p>
</li>
<li>
<p>Added in <code>lock</code> command.</p>
</li>
<li>
<p>Added in <code>unlock</code> and <code>setpw</code> command.</p>
</li>
<li>
<p>Added in data file encryption and decryption features.</p>
</li>
<li>
<p>Added in the data file encryption enhancement. (Pull requests <a href="https://github.com/CS2103JAN2018-F14-B4/main/pull/134">#134</a>)</p>
</li>
<li>
<p>Added one case insensitive feature. (Pull requests <a href="https://github.com/CS2103JAN2018-F14-B4/main/pull/179">#179</a>)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Documentation:</p>
<div class="ulist">
<ul>
<li>
<p>Added my major and minor feature into UserGuide and DeveloperGuide, adding my Project Portfolio. (<a href="https://github.com/CS2103JAN2018-F14-B4/main/pull/193">#193</a>)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Community:</p>
<div class="ulist">
<ul>
<li>
<p>PRs reviewed. (<a href="https://github.com">#12</a>, <a href="https://github.com/CS2103JAN2018-F14-B4/main/pull/84">#84</a>, <a href="https://github.com/CS2103JAN2018-F14-B4/main/pull/79">#79</a>,
<a href="https://github.com/CS2103JAN2018-F14-B4/main/pull/68">#68</a>, <a href="https://github.com/CS2103JAN2018-F14-B4/main/pull/44">#44</a>)</p>
</li>
<li>
<p>Reported bugs and suggestions for other teams in the class. (Issues <a href="https://github.com/CS2103JAN2018-F11-B3/main/issues/116">#116</a>,
<a href="https://github.com/CS2103JAN2018-F11-B3/main/issues/119">#119</a>, <a href="https://github.com/CS2103JAN2018-F11-B3/main/issues/133">#133</a>,
<a href="https://github.com/CS2103JAN2018-F11-B3/main/issues/137">#137</a>, <a href="https://github.com/CS2103JAN2018-F11-B3/main/issues/118">#118</a>,
<a href="https://github.com/CS2103JAN2018-F11-B3/main/issues/123">#123</a>)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contributions-to-the-user-guide"><a class="anchor" href="#contributions-to-the-user-guide"></a>Contributions to the User Guide</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Given below are sections I contributed to the User Guide. They showcase my ability to write documentation targeting end-users.</em></p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="edit-command"><a class="anchor" href="#edit-command"></a>Editing a book : <code>edit</code> <em>(since v1.4)</em></h3>
<div class="paragraph">
<p>After reading a book, you may want to give the book a rating or set the book as read.
Or, you may want to change the priority of books to remind yourself what you should read next. These can be done using <code>edit</code>.<br>
Format: <code>edit INDEX [s/STATUS] [p/PRIORITY] [r/RATING]</code></p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Edits the book at the specified <code>INDEX</code>. The index refers to the index number shown in the most recent listing. The index <strong>must be a positive integer</strong> 1, 2, 3, &#8230;&#8203;</p>
</li>
<li>
<p>At least one of the optional fields must be provided.</p>
</li>
<li>
<p>Existing values will be updated to the input values.</p>
</li>
<li>
<p><code>STATUS</code> must be one of the following (items in parenthesis are aliases): <code>read</code> (<code>r</code>), <code>unread</code> (<code>u</code>), or <code>reading</code> (<code>rd</code>).</p>
</li>
<li>
<p><code>PRIORITY</code> must be one of the following (items in parenthesis are aliases): <code>none</code> (<code>n</code>), <code>low</code> (<code>l</code>), <code>medium</code> (<code>m</code>), or <code>high</code> (<code>h</code>).</p>
</li>
<li>
<p><code>RATING</code> must be a valid rating from 0 to 5, or -1 to remove rating.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
You can only edit books from your book shelf.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Suppose you have a few unread books in your book shelf.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/EditCommandStart.png" alt="EditCommandStart" width="650">
</div>
</div>
<div class="paragraph">
<p>You may want to differentiate them based on how eager you are to read each book.
This helps you to better keep track of what you plan to read next, and also allows you to view the books in a more useful order.<br>
For example, if you feel that reading <code>Gel Electrophoresis of Proteins</code> is more urgent than reading the other books, you can change its priority to high using <code>edit 3 p/high</code>.</p>
</div>
<div class="paragraph">
<p>Bibliotek shows <code>Edited Book: TITLE - Authors: AUTHORS</code> to indicate that the <code>edit</code> was successful.
In the left panel, you can see that the priority label of <code>Gel Electrophoresis of Proteins</code> is changed to <code>High</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/EditCommandMid.png" alt="EditCommandMid" width="650">
</div>
</div>
<div class="paragraph">
<p>Other examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>edit 3 p/low</code><br>
Changes the priority of the 3rd book to <code>LOW</code>.</p>
</li>
<li>
<p><code>edit 2 s/read r/5</code><br>
Marks the 2nd book as <code>READ</code> and changes its rating to <code>5</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="setpw-command"><a class="anchor" href="#setpw-command"></a>Changing/Setting a password : <code>setpw</code> <em>(since v1.5)</em></h3>
<div class="paragraph">
<p>If you want to keep your data secure, you can opt to set a password for Bibliotek. This password will be used to encrypt your data.
After starting up Bibliotek, you will have to unlock it using your password before being able to perform any commands.<br>
Format: <code>setpw [old/OLD_PASSWORD] [new/NEW_PASSWORD]</code></p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Changes the password from <code>OLD_PASSWORD</code> to <code>NEW_PASSWORD</code>.</p>
</li>
<li>
<p><code>OLD_PASSWORD</code> and <code>NEW_PASSWORD</code> are case sensitive.</p>
</li>
<li>
<p>At least one of the 2 fields must be provided.</p>
</li>
<li>
<p>By default, there is no password.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To set a password, use <code>setpw new/NEW_PASSWORD</code>.<br>
Similarly, to delete the password, use <code>setpw old/OLD_PASSWORD</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the <code>OLD_PASSWORD</code> that you provided is correct, Bibliotek shows <code>Successfully changed your password</code> to indicate that your password is changed.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/setpassword1.png" alt="setpassword1" width="650">
</div>
</div>
<div class="paragraph">
<p>On the other hand, if the <code>OLD_PASSWORD</code> that you provided is incorrect, Bibliotek shows <code>Incorrect old password. Please try again.</code> to indicate that your password is not changed.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/setpassword2.png" alt="setpassword2" width="650">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you provide a <code>OLD_PASSWORD</code> when you in fact have no password, it is considered to be incorrect.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You should remember your password after setting a new one.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="lock-command"><a class="anchor" href="#lock-command"></a>Locking the app : <code>lock</code> <em>(since v1.5)</em></h3>
<div class="paragraph">
<p>If you are going away for a moment and want to prevent others from messing with the application, you can perform <code>lock</code>.<br>
Format: <code>lock</code></p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Locks the app. No commands can be performed other than <code>help</code> and <code>unlock</code>.</p>
</li>
<li>
<p>The app is locked upon start up if you have a password.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you perform <code>lock</code> without a password, anyone can <code>unlock</code> your application.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you perform <code>lock</code>, Bibliotek responds with <code>Successfully locked the app.</code> to indicate that your <code>lock</code> is successful.
All your displayed books will be hidden and the welcome panel will be shown on the right panel.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/LockCommand.png" alt="LockCommand" width="650">
</div>
</div>
<div class="paragraph">
<p>If your application is locked, you cannot perform any commands other than <code>help</code> and <code>unlock</code>.
Performing any other valid commands, for example <code>list</code>, will be responded with <code>The app is locked, please unlock it first!</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/LockCommandMessage.png" alt="LockCommandMessage" width="650">
</div>
</div>
</div>
<div class="sect2">
<h3 id="unlock-command"><a class="anchor" href="#unlock-command"></a>Unlocking the app : <code>unlock</code> <em>(since v1.5)</em></h3>
<div class="paragraph">
<p>If you previously performed <code>lock</code>, use <code>unlock</code> to unlock the app.<br>
Format: <code>unlock PASSWORD</code></p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Unlocks the app.</p>
</li>
<li>
<p><code>PASSWORD</code> is case sensitive. Leading and trailing spaces are ignored.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you did not set a password, simply type <code>unlock</code> to unlock the app.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you perform <code>unlock</code> with your password, Bibliotek responds with <code>Succesfully unlocked the app.</code> to indicate that your <code>unlock</code> is successful.
All the books in your book shelf will be displayed.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/UnlockCommand.png" alt="UnlockCommand" width="650">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you really forgot your password and cannot unlock the system, you can reset Bibliotek by deleting all your data files.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contributions-to-the-developer-guide"><a class="anchor" href="#contributions-to-the-developer-guide"></a>Contributions to the Developer Guide</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Given below are sections I contributed to the Developer Guide. They showcase my ability to write technical documentation and the technical depth of my contributions to the project.</em></p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="edit-status-priority-and-rating-of-books"><a class="anchor" href="#edit-status-priority-and-rating-of-books"></a>Edit status, priority, and rating of books</h3>
<div class="paragraph">
<p>The <code>edit</code> command allows the user to change the priority, status and rating of books in his/her book shelf to facilitate organization and management of books.</p>
</div>
<div class="sect3">
<h4 id="current-implementation"><a class="anchor" href="#current-implementation"></a>Current implementation</h4>
<div class="paragraph">
<p>When <code>edit</code> command is entered,</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>EditCommandParser</code> will extract the index and the parameters from the user input.</p>
</li>
<li>
<p><code>EditCommandParser</code> checks that at least one parameter is present, and that the parameter(s) are valid.</p>
</li>
<li>
<p><code>EditCommandParser</code> creates an <code>EditCommand</code> with the index and parameter(s).</p>
</li>
<li>
<p><code>EditCommand</code> is preprocessed to check that <code>ActiveListType</code> is correct and index is valid.</p>
</li>
<li>
<p>The <code>Book</code> to edit (<code>bookToEdit</code>) is identified by the index. Another <code>Book</code> (<code>editedBook</code>) is created based on the specified parameters.</p>
</li>
<li>
<p><code>editedBook</code> replaces <code>bookToEdit</code> in <code>BookShelf</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Sequence Diagram</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/editseq.png" alt="editseq" width="550">
</div>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations"><a class="anchor" href="#design-considerations"></a>Design considerations</h4>
<div class="sect4">
<h5 id="aspect-presentation-of-rating"><a class="anchor" href="#aspect-presentation-of-rating"></a>Aspect: Presentation of rating</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Alternative 1:</strong> Show users the rating as a number.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Easy to implement.</p>
</li>
<li>
<p>Cons: Not aesthetically appealing.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Alternative 2 (current choice):</strong> Show users the rating as stars.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Difficult to implement.</p>
</li>
<li>
<p>Cons: Improves the aesthetic appeal and clarity.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="aspect-interpretation-of-unspecified-parameters"><a class="anchor" href="#aspect-interpretation-of-unspecified-parameters"></a>Aspect: Interpretation of unspecified parameters</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Alternative 1 (current choice):</strong> Unspecified parameters are left unchanged.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Users can omit parameters that they do not wish to change.</p>
</li>
<li>
<p>Cons: More difficult to implement.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Alternative 2:</strong> Unspecified parameters are set to default value.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Easy to implement.</p>
</li>
<li>
<p>Cons: Users need to specify all parameters to change one.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="encrypt-data"><a class="anchor" href="#encrypt-data"></a>Encrypt data</h3>
<div class="paragraph">
<p>This allows the user to protect his book shelf data with a password so that others cannot gain access to these data.</p>
</div>
<div class="sect3">
<h4 id="current-implementation-2"><a class="anchor" href="#current-implementation-2"></a>Current implementation</h4>
<div class="sect4">
<h5 id="encrypt-the-bookshelf-xml"><a class="anchor" href="#encrypt-the-bookshelf-xml"></a>Encrypt the Bookshelf.xml</h5>
<div class="paragraph">
<p>An addition class <code>CipherEngine</code> is added to the <code>Bookshelf</code> class. This class contatins some methods
  to encrypt or decrypt file(<code>Bookshelf.xml</code>)and <code>password</code>.<br>
  Note that when 'CipherEngine' encrypt the file, it will use the (encryped)<code>password</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong> Every time user make change in <code>Bookshelf</code> </strong></p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <code>model manager</code> will post an <code>BookshelfChangedEvent</code>.</p>
</li>
<li>
<p>Before saving the data into <code>Bookshelf.xml</code>, the system will check whether <code>Bookshelf</code> is protected by the <code>password</code>(checking
whether the <code>password</code> is <code>defaultpassword</code>: "").</p>
</li>
<li>
<p>When the <code>password</code> is not default, the <code>Bookshelf.xml</code> will be encrypted.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong> Every time user set the new <code>password</code> </strong></p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <code>Setpwcommand</code> will check the <code>password</code>.</p>
</li>
<li>
<p>If the new <code>password</code> is equal to "", the <code>Lockmanager</code> will set <code>isProtected</code> to be false.</p>
</li>
<li>
<p>The isProtect will be checked by <code>xmlBookshelfstorage</code> whether to  encrypt the "Bookshelf.xml" and save
the data into <code>Bookshelf.xml</code>.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong> When the system need to be encrypt </strong></p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <code>password</code> will be encode, and set it to be a key to encrypt the file(<code>Bookshelf.xml</code>).</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="lock-the-book-shelf"><a class="anchor" href="#lock-the-book-shelf"></a>Lock the book shelf</h5>
<div class="paragraph">
<p>An addition class <code>LockManager</code> is added to save the password and the situation of the locking system.<br>
The default <code>password</code> provided for the new user is defaultpassword(""), which means that the <code>Bookshelf</code> is not locked.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong> When <code>Lock</code> command is entered </strong></p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>LockCommand</code> is processed to set <code>isLock</code>(<code>LockManager</code>) to be true.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
. The <code>Bookshelf</code> cannot be run any command except <code>unlock</code> and <code>help</code> command.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>When the <code>Bookshelf</code> is locked and <code>unlock</code> command is entered</strong></p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>UnlockCommandParser</code> will extract <code>password</code> from the user input.</p>
</li>
<li>
<p><code>UnlockCommandParser</code> creates an <code>UnlockCommand</code> for the <code>password</code>.</p>
</li>
<li>
<p><code>UnlockCommand</code> is preprocessed to execute `LockManager&#8217;s unlock(password).</p>
</li>
<li>
<p>If the password is corrct, the unlock will be run successfully, otherwise it will send a WRONG_PASSWORD commandresult.</p>
</li>
<li>
<p><code>UnlockCommand</code> is processed to set isLock(LockManager) to be false.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>When <code>setpw</code> command is entered</strong></p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>setpasswordCommandParser</code> will extract the old key and new key from the user input.</p>
</li>
<li>
<p><code>setpwParser</code> checks that  two parameters are valid.</p>
</li>
<li>
<p><code>setpasswordCommandParser</code> creates an <code>setpwCommand</code> with the parameters.</p>
</li>
<li>
<p><code>setpwCommand</code> is preprocessed to check that oldKey is correct using <code>LockManager</code>.</p>
</li>
<li>
<p>If the oldKey is correct, <code>setpwCommand</code> will post a <code>passwordChangedevent</code>.</p>
</li>
<li>
<p>MainApp will handle it, and set <code>UserPrefs.password</code> to be new encoded <code>password</code>(using cipherEngine).</p>
</li>
</ol>
</div>
</li>
<li>
<p>The encode key are implement in this way:
[source,java]</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>    public static String encrypKey(String mykey) throws Exception {
        byte[] byarray = encrypt(mykey.getBytes(ENCODE), defaultKey.getBytes(ENCODE));
        String encryptkey = new BASE64Encoder().encode(byarray);
        return encryptkey;
    }

    public static byte[] encrypt(byte[] mykey, byte[] key) throws Exception {
        SecureRandom secureRandom = new SecureRandom();

        DESKeySpec desKeySpec = new DESKeySpec(key);

        SecretKeyFactory secretKeyFactory = SecretKeyFactory.getInstance(DES);
        SecretKey securekey = secretKeyFactory.generateSecret(desKeySpec);

        Cipher cipher = Cipher.getInstance(DES);

        cipher.init(Cipher.ENCRYPT_MODE, securekey, secureRandom);

        return cipher.doFinal(mykey);
    }</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The encode key are implement in this way:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>    public static String decryptKey(String yourkey) throws IOException, Exception {
        if (yourkey == null) {
            return null;
        }
        BASE64Decoder base64Decoder = new BASE64Decoder();
        byte[] decodeBuffer = base64Decoder.decodeBuffer(yourkey);
        byte[] bytes = decrypt(decodeBuffer, defaultKey.getBytes(ENCODE));
        return new String(bytes, ENCODE);
    }

    private static byte[] decrypt(byte[] yourkey, byte[] key) throws Exception {

        SecureRandom secureRandom = new SecureRandom();

        DESKeySpec desKeySpec = new DESKeySpec(key);

        SecretKeyFactory secretKeyFactory = SecretKeyFactory.getInstance(DES);
        SecretKey securekey = secretKeyFactory.generateSecret(desKeySpec);

        Cipher cipher = Cipher.getInstance(DES);

        cipher.init(Cipher.DECRYPT_MODE, securekey, secureRandom);

        return cipher.doFinal(yourkey);
    }</pre>
</div>
</div>
<hr>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-05-14 08:49:23 UTC
</div>
</div>
</body>
</html>